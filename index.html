<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bookkeeping Test</title>
</head>
<body>
<h2>Test Bookkeeping System</h2>

<form id="form">
  <input type="text" id="voucherID" placeholder="Voucher ID" required><br>
  <input type="date" id="date" required><br>
  <input type="text" id="account" placeholder="Account Name" required><br>
  <input type="number" id="debit" placeholder="Debit"><br>
  <input type="number" id="credit" placeholder="Credit"><br>
  <input type="text" id="description" placeholder="Description"><br>
  <button type="submit">Add Transaction</button>
</form>

<table border="1" id="table">
  <tr>
    <th>VoucherID</th><th>Date</th><th>Account</th><th>Debit</th><th>Credit</th><th>Description</th>
  </tr>
</table>

<script>
const webAppURL = "https://script.google.com/macros/s/AKfycbzio0sBprm1M9thE4huOTSucYjQW1YfL63EQ7dPRsxAmJCyjim1vMmOpTv1Y8HWXAQK/exec";

// Add transaction
document.getElementById("form").addEventListener("submit", async e => {
  e.preventDefault();
  const data = {
    voucherID: document.getElementById("voucherID").value,
    date: document.getElementById("date").value,
    account: document.getElementById("account").value,
    debit: parseFloat(document.getElementById("debit").value||0),
    credit: parseFloat(document.getElementById("credit").value||0),
    description: document.getElementById("description").value
  };
  await fetch(webAppURL + "?action=addTransaction", {
    method: "POST",
    body: JSON.stringify(data)
  });
  loadTransactions();
});

// Load transactions
async function loadTransactions(){
  const res = await fetch(webAppURL.replace("/exec","") + "/execTransactions");
  const transactions = await res.json();
  const table = document.getElementById("table");
  table.innerHTML = `<tr>
    <th>VoucherID</th><th>Date</th><th>Account</th><th>Debit</th><th>Credit</th><th>Description</th>
  </tr>`;
  transactions.forEach(t => {
    const row = table.insertRow();
    t.forEach(cell => row.insertCell().innerText = cell);
  });
}

loadTransactions();
</script>
</body>
</html>
